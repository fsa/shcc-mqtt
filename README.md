# Плагин SHCC для взаимодействия с MQTT брокером

Обеспечивает поддержу оборудования через MQTT брокеров.

## Настройка

Настройки производятся в файле `/config/services.yaml`, но для удобства лучше разместить их в отдельном файле, например, `/config/shcc/daemons.yaml` и импортировать их из основного файла.

Перед запуском демона необходимо создать сервис в разделе `services`, например, «MQTT». Имя сервиса должно начинаться на `shcc.daemon.`, после чего указывается имя сервиса, которое необходимо будет указать при запуске. Рекомендуется использовать «MQTT».

```yaml
services:
  shcc.daemon.MQTT:
    class: ShccPlugin\Mqtt\Daemon
    autowire: true
    tags: ['shcc.daemon']
```

Параметры запуска демона демона указываются в секции `parameters` в разделе с именем, аналогичным имени ранее созданного сервиса.

```yaml
parameters:
  shcc.daemon.MQTT:
    server_ip: "[fd01::8]"
    password: "pAsSw0rD"
    client_id: "shcc-server"
    topics:
      - "zigbee/ht_cabinet/temperature"
      - "zigbee/ht_cabinet/humidity"
      - "zigbee/ht_cabinet/voltage"
```

При необходимости можно создать несколько сервисов, если у вас есть несколько MQTT брокеров. В таком случае рекомендуется добавить к имени сервиса «MQTT» дополнительный суффикс, например, «MQTT-1».

Доступные параметры для настройки:

- `server_addr` — адрес брокера, по умолчанию 127.0.0.1;
- `port` — порт брокера, по умолчанию 1883;
- `client_id` — идентификатор клиента, по умолчанию shcc-host;
- `username` — имя пользователя для подключения к брокеру, по умолчанию shcc;
- `password` — пароль пользователя для подключения к брокеру, рекомендуется всегда указывать явно;
- `topics` — массив топиков, на которые будет осуществлена подписка.
